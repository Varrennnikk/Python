<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Лаба 4: Работа с BioPython</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <h1>Вампирские Лабораторные по Python</h1>
        <nav>
            <ul>
                <li><a href="index.html">Главная</a></li>
                <li><a href="lab1.html">Лаба 1</a></li>
                <li><a href="lab2.html">Лаба 2</a></li>
                <li><a href="lab3.html">Лаба 3</a></li>
                <li><a href="lab4.html">Лаба 4</a></li>
            </ul>
        </nav>
    </header>

    <main>
        <section id="lab4">
            <h2>Лабораторная работа 4: "Работа с BioPython"</h2>
            <h3>Цель работы</h3>
            <p>Обработка биологических данных в формате GenBank:</p>
            <ul>
                <li>Объединение файлов</li>
                <li>Анализ GC-состава</li>
                <li>Трансляция кодирующих областей</li>
            </ul>

            <h3>Задачи</h3>
            <h4>Задание 1. Формирование исходного файла</h4>
            <ul>
                <li>Загрузить по 5 CDS-последовательностей для двух видов с NCBI в формате GenBank.</li>
                <li>Объединить записи в единый файл средствами BioPython.</li>
                <li>Проверить, что итоговый файл содержит не менее 10 CDS.</li>
            </ul>

            <h4>Задание 2. Анализ GC-составов</h4>
            <ul>
                <li>Прочитать файл GenBank, извлечь последовательности.</li>
                <li>Вычислить GC-состав для каждой последовательности.</li>
                <li>Отсортировать последовательности по возрастанию GC-состава.</li>
                <li>Вывести результаты с указанием ID, описания и значения GC.</li>
            </ul>

            <h4>Задание 3. Трансляция</h4>
            <ul>
                <li>Извлечь кодирующие области (CDS) из файла GenBank.</li>
                <li>Транслировать нуклеотидные последовательности в аминокислотные.</li>
                <li>Вывести белковые последовательности с указанием исходных CDS.</li>
            </ul>

            <h3>Инструменты</h3>
            <h4>Задание 1</h4>
            <p><strong>Библиотеки:</strong></p>
            <ul>
                <li>Bio.SeqIO для чтения/записи GenBank-файлов.</li>
            </ul>
            <p><strong>Алгоритм:</strong></p>
            <ol>
                              <li>Скачивание данных с NCBI (вручную).</li>
                <li>Объединение файлов через `SeqIO.write(records, "output.gb", "genbank")`.</li>
            </ol>

            <h4>Задание 2</h4>
            <p><strong>Библиотеки:</strong></p>
            <ul>
                <li>Bio.SeqIO для парсинга GenBank.</li>
                <li>tkinter для GUI.</li>
            </ul>
            <p><strong>Алгоритм:</strong></p>
            <ol>
                <li>Чтение файла: `SeqIO.parse(filename, "genbank")`.</li>
                <li>Расчет GC-состава:
                    <pre><code>gc_content = (seq.count("G") + seq.count("C")) / len(seq)</code></pre>
                </li>
                <li>Сортировка: `sorted(sequences, key=lambda x: x[2])`.</li>
            </ol>

            <h4>Задание 3</h4>
            <p><strong>Библиотеки:</strong></p>
            <ul>
                <li>Bio.Seq для трансляции.</li>
            </ul>
            <p><strong>Алгоритм:</strong></p>
            <ol>
                <li>Извлечение CDS из записей GenBank.</li>
                <li>Трансляция: `seq.translate(table="стандартный_код")`.</li>
            </ol>

            <h3>Ошибки и исправления</h3>
            <h4>Задание 1</h4>
            <ul>
                <li><strong>Ошибка:</strong> Несовместимость форматов файлов от разных видов.
                    <strong>Исправление:</strong> Проверка и конвертация в единый формат GenBank.</li>
                <li><strong>Ошибка:</strong> Отсутствие CDS в некоторых записях.
                    <strong>Исправление:</strong> Фильтрация записей с `if "CDS" in record.features`.</li>
            </ul>

            <h4>Задание 2</h4>
            <ul>
                <li><strong>Ошибка:</strong> Некорректный расчет GC для пустых последовательностей.
                    <strong>Исправление:</strong> Добавление проверки `if len(seq) > 0`.</li>
                <li><strong>Ошибка:</strong> Неправильная сортировка из-за строкового сравнения GC.
                    <strong>Исправление:</strong> Преобразование GC в `float` перед сортировкой.</li>
            </ul>

            <h4>Задание 3</h4>
            <ul>
                <li><strong>Ошибка:</strong> Трансляция некодирующих областей.
                    <strong>Исправление:</strong> Извлечение только CDS-фрагментов.</li>
                <li><strong>Ошибка:</strong> Игнорирование рамки считывания.
                    <strong>Исправление:</strong> Учет `frame` в `feature.qualifiers.get("transl_table")`.</li>
            </ul>

            <h3>Выводы</h3>
            <p>Успешно создан объединенный GenBank-файл с 10+ CDS.</p>
            <p>Реализован расчет и сортировка GC-составов с выводом в GUI.</p>
            <p>Получены белковые последовательности через трансляцию CDS.</p>

            <h3>Файлы с кодом</h3>
            <p><a href="#">лаба 4 - Лабораторная работа 4</a></p>
        </section>
    </main>

    <footer>
        <p>&copy; 2024 Вампирские Лаборатории</p>
    </footer>
</body>
</html>
