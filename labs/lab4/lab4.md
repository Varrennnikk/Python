# Лабораторная работа 4: Работа с BioPython

## Цель работы

Целью данной лабораторной работы являлось изучение и практическое применение библиотеки BioPython для обработки биологических данных в формате GenBank. Были выполнены задачи по объединению файлов GenBank, анализу GC-состава последовательностей ДНК, а также трансляции кодирующих областей (CDS) в аминокислотные последовательности.

## Задачи

В процессе выполнения работы были поставлены и решены следующие задачи:

### Задание 1. Формирование исходного файла

  •  Загрузка по 5 CDS-последовательностей для двух видов с NCBI в формате GenBank.
  •  Объединение записей в единый файл средствами BioPython.
  •  Проверка, что итоговый файл содержит не менее 10 CDS.
  
### Задание 2. Анализ GC-составов

  •  Прочитать файл GenBank, извлечь последовательности.
  •  Вычислить GC-состав для каждой последовательности.
  •  Отсортировать последовательности по возрастанию GC-состава.
  •  Вывод результатов с указанием ID, описания и значения GC.
  
### Задание 3. Трансляция

  •  Извлечь кодирующие области (CDS) из файла GenBank.
  •  Транслировать нуклеотидные последовательности в аминокислотные.
  •  Вывести белковые последовательности с указанием исходных CDS.

## Инструменты и алгоритмы

Для выполнения работы использовались следующие инструменты и алгоритмы:

### Инструменты

•  Язык программирования: Python.
•  Библиотека BioPython:
  •  Bio.SeqIO - для чтения/записи GenBank-файлов и парсинга GenBank.
  •  Bio.Seq - для трансляции.
•  Текстовый редактор для написания и редактирования кода.

### Алгоритмы

#### Задание 1:
  1. Скачивание данных с NCBI (вручную) согласно заданию.
  2. Объединение файлов GenBank с использованием функции SeqIO.write(records, "output.gb", "genbank").
#### Задание 2:
  1. Чтение файла GenBank с использованием функции SeqIO.parse(filename, "genbank").
  2. Расчет GC-состава с использованием формулы gc_content = (seq.count("G") + seq.count("C")) / len(seq).
  3. Сортировка последовательностей по возрастанию GC-состава с использованием функции sorted(sequences, key=lambda x: x[2]).
#### Задание 3:
  1. Извлечение CDS из записей GenBank.
  2. Трансляция последовательностей CDS в аминокислотные последовательности с использованием функции seq.translate(table="стандартный_код").
     
## Ошибки и исправления

В процессе выполнения работы были выявлены и исправлены следующие ошибки:

### Задание 1:
  •  Ошибка: Несовместимость форматов файлов от разных видов.
  •  Исправление: Перед объединением файлов была выполнена проверка и, при необходимости, конвертация форматов в единый формат GenBank.
  •  Ошибка: Отсутствие CDS в некоторых записях.
  •  Исправление: Была добавлена фильтрация записей с использованием условия if "CDS" in record.features, чтобы исключить записи, не содержащие CDS.
### Задание 2:
  •  Ошибка: Некорректный расчет GC для пустых последовательностей.
  •  Исправление: Добавлена проверка if len(seq) > 0 перед вычислением GC-состава, чтобы избежать деления на ноль.
  •  Ошибка: Неправильная сортировка из-за строкового сравнения GC.
  •  Исправление: GC-состав был преобразован в тип float перед сортировкой, чтобы обеспечить корректное численное сравнение.
### Задание 3:
  •  Ошибка: Трансляция некодирующих областей.
  •  Исправление: Было обеспечено извлечение только CDS-фрагментов из GenBank записей перед трансляцией.
  •  Ошибка: Игнорирование рамки считывания.
  •  Исправление: При трансляции учитывалась рамка считывания (frame), указанная в feature.qualifiers.get("transl_table").

## Выводы

В ходе выполнения лабораторной работы были успешно достигнуты поставленные цели и решены все задачи.

1. Были получены навыки работы с библиотекой BioPython для обработки биологических данных в формате GenBank.
2. Успешно создан объединенный GenBank-файл, содержа
щий более 10 CDS.
3. Реализован алгоритм расчета и сортировки GC-составов для последовательностей ДНК.
4. Были успешно транслированы нуклеотидные последовательности CDS в аминокислотные последовательности, что является важным шагом в анализе генетической информации.

Полученные навыки и опыт могут быть использованы в дальнейших исследованиях и проектах, связанных с биоинформатикой и анализом геномных данных.

•  [lab4.py](lab4.py)

```
