# Лабораторные работы по Python

## Файлы с кодом
- [лаба 1](https://github.com/varrennnikk/python/blob/лабы/лабы/лаба1) - Лабораторная работа 1
- [лаба 2](https://github.com/varrennnikk/python/blob/лабы/лабы/лаба2) - Лабораторная работа 2
- [лаба 3](https://github.com/varrennnikk/python/blob/лабы/лабы/лаба3) - Лабораторная работа 3
- [лаба 4](https://github.com/varrennnikk/python/blob/лабы/лабы/лаба4) - Лабораторная работа 4

---

## Лабораторная работа 1: "Подсчёт точечных мутаций"

### Цель работы
Разработка программы для вычисления расстояния Хэмминга между двумя строками ДНК равной длины.

## Задачи
1.  Изучить понятие расстояния Хэмминга и его применение в биоинформатике.
2.  Реализовать алгоритм для вычисления расстояния Хэмминга между двумя строками ДНК.
3.  Протестировать реализованную программу с использованием предоставленных входных данных.
4.  Оформить отчёт о проделанной работе.

### Инструменты и алгоритмы
Инструменты:
    •   Язык программирования: Python.
    •   IDE: Visual Studio Code, PyCharm.
Алгоритм:
    1.  Ввод данных: Получение двух строк ДНК (s и t) равной длины.
    2.  Проверка длины: Убедиться, что длина обеих строк совпадает. Если нет - сообщить об ошибке и остановить выполнение.
    3.  Вычисление расстояния Хэмминга:
        •   Инициализация переменной distance значением 0.
        •   Цикл по символам строк:
            •   Если символы на текущей позиции в строках s и t не совпадают, увеличить значение distance на 1.
    4.  Вывод результата: Вывод значения переменной distance в качестве расстояния Хэмминга.

### Ошибки и исправления
1. Ошибка: Отсутствие проверки на равенство длин строк.
  Исправление: Добавление в код проверки if len(s) != len(t): и вывод сообщения об ошибке, если строки имеют разную длину, с прекращением работы функции.
2. Ошибка: Неправильный подсчет расстояния при несовпадении символов.
  Исправление: Убедиться, что переменная distance инкрементируется (distance += 1)  внутри условия if s[i] != t[i]:.
3. Ошибка: Использование неправильных индексов при обращении к символам строк.
  Исправление: Проверка, что индекс i внутри цикла for не выходит за пределы длин строк.  В приведённом выше коде эта ошибка отсутствует, так как цикл for i in range(len(s)): гарантирует корректный перебор индексов.

### Выводы

В ходе выполнения лабораторной работы был изучен и реализован алгоритм для вычисления расстояния Хэмминга между двумя строками ДНК равной длины.  Программа позволяет определить количество позиций, в которых символы двух строк различаются, что является важным показателем при анализе генетических данных и изучении мутаций.  Разработанная программа может быть использована в дальнейшем для решения более сложных задач биоинформатики, связанных с анализом последовательностей ДНК.  При реализации алгоритма особое внимание уделялось обработке возможных ошибок, таких как разная длина строк, что повышает надежность и устойчивость разработанной программы.

---

## Лабораторная работа 2: "Вычисление GC-состава"

### Цель работы
Разработать программу для вычисления GC-состава последовательностей ДНК и определения последовательности с наибольшим GC-составом.

### Задачи
1. Изучить понятие GC-состава и его значимость в биоинформатике.
2. Реализовать алгоритм для чтения последовательностей ДНК из формата FASTA.
3. Реализовать алгоритм для вычисления GC-состава каждой последовательности.
4. Определить и вывести идентификатор последовательности с наибольшим GC-составом и значение GC-состава в процентах.
5. Протестировать реализованную программу с использованием предоставленных входных данных.
6. Оформить отчёт о проделанной работе.

### Инструменты и алгоритмы
Инструменты:
  •  Язык программирования: Python (или любой другой удобный для вас язык).
  •  IDE: Visual Studio Code, PyCharm (или любой другой редактор кода).
Алгоритм:
  1. Чтение данных из FASTA:
    •  Создание функции для чтения FASTA файла.
    •  Итерирование по строкам файла.
    •  Если строка начинается с ">" - это идентификатор последовательности.
    •  Все остальные строки - это последовательность ДНК (соединять в одну строку).
    •  Хранить пары "идентификатор - последовательность" в словаре (или списке кортежей).
  2. Вычисление GC-состава:
    •  Для каждой последовательности:
      •  Подсчет количества символов 'G' и 'C' в последовательности.
      •  Вычисление GC-состава по формуле: (количество G + количество C) / длина последовательности.
      •  Перевод результата в проценты (умножение на 100).
  3. Определение последовательности с максимальным GC-составом:
    •  Итерирование по всем вычисленным GC-составам.
    •  Определение максимального значения GC-состава и идентификатора соответствующей последовательности.
  4. Вывод результата:
    •  Вывод идентификатора последовательности с максимальным GC-составом.
    •  Вывод значения GC-состава в процентах, отформатированного до нескольких знаков после запятой.

### Ошибки и исправления
1. Ошибка: Неправильное чтение FASTA файла (неправильная обработка многострочных последовательностей).
  Исправление: Добавлена логика для чтения многострочных последовательностей в FASTA файле. Теперь последовательности присоединяются друг к другу, пока не будет встречен новый идентификатор. Также добавлена обработка последнего элемента в файле.
2. Ошибка: Неправильное вычисление GC-состава.
  Исправление: Убедиться, что учитываются как 'G', так и 'C', и что результат делится на длину последовательности, а не на что-то другое.
3. Ошибка: Неправильное форматирование вывода GC-состава.
  Исправление: Использовать форматирование строк Python (f-строки или .format()) для вывода значения GC-состава с требуемым количеством знаков после запятой (в данном случае, 5).
     
### Выводы
В ходе выполнения лабораторной работы была разработана программа для вычисления GC-состава последовательностей ДНК, прочитанных из FASTA файла, и определения последовательности с наибольшим GC-составом. Данная программа может быть использована для анализа геномных данных, идентификации генов и изучения особенностей структуры ДНК. Реализация алгоритма чтения FASTA файлов и вычисления GC-состава позволила получить практический опыт работы с биоинформатическими данными и освоить основные принципы обработки генетических последовательностей. Разработанная программа имеет потенциал для дальнейшего расширения и применения в более сложных задачах анализа ДНК.

---

## Лабораторная работа 3: "Представление данных в Python"

### Цель работы
Визуализация данных с использованием библиотек Python (matplotlib, seaborn).

### Задачи
## Задание 1: Построение диаграммы рассеяния.
  •  Выбрать два столбца (фактора) из заданных табличных данных.
  •  Построить диаграмму рассеяния.
  •  Раскрасить маркеры в зависимости от принадлежности к определенному классу.
  
## Задание 2: Построение графика динамики временных рядов.
  •  Загрузить данные временных рядов.
  •  Построить графики динамики для заданных временных рядов на определенный промежуток времени (единый или отдельные графики).

### Инструменты и Алгоритмы

Инструменты:
  •  Язык программирования: Python.
  •  Библиотеки:
    *  pandas - для загрузки и обработки табличных данных.
    *  matplotlib - для построения графиков.
    *  seaborn - для улучшения внешнего вида графиков (опционально).
  •  IDE: Visual Studio Code, PyCharm (или любой другой редактор кода).

Алгоритмы:

  Задание 1: Диаграмма рассеяния
  1. Загрузка данных: Использовать pandas.read_csv() (или другую функцию, в зависимости от формата файла) для загрузки данных в pandas.DataFrame. Использовать один из датасетов, указанных в приложении А. Например, использовать sklearn.datasets.load_iris().
  2. Выбор факторов и классов: Определить столбцы, которые будут использованы в качестве факторов (оси X и Y) и столбец, определяющий классы.
  3. Построение диаграммы: Использовать matplotlib.pyplot.scatter() для построения диаграммы рассеяния. В цикле по уникальным классам:
    *  Выбрать данные, принадлежащие текущему классу.
    *  Вызвать scatter() с выбранными данными и указать цвет и метку для данного класса.
  4. Добавление легенды и меток: Использовать matplotlib.pyplot.legend(), matplotlib.pyplot.xlabel(), matplotlib.pyplot.ylabel(), и matplotlib.pyplot.title() для добавления легенды, меток осей и заголовка графика.

  Задание 2: График временных рядов
  1. Загрузка данных: Загрузить данные временных рядов в pandas.DataFrame. Использовать один из датасетов, указанных в приложении Б. Загрузка часто осуществляется через pandas.read_csv() или аналогичные функции.
  2. Выбор временных рядов и промежутка: Определить, какие временные ряды нужно отобразить, и задать временной промежуток. Может потребоваться преобразование столбца с датами в формат даты и времени с помощью pandas.to_datetime().
  3. Построение графика: Использовать matplotlib.pyplot.plot() для построения графика.
    *  Для единого графика: построить все временные ряды на одном графике.
    *  Для отдельных графиков: для каждого временного ряда создать отдельный график.
  4. Добавление легенды и меток: Использовать matplotlib.pyplot.legend(), matplotlib.pyplot.xlabel(), matplotlib.pyplot.ylabel(), и matplotlib.pyplot.title() для добавления легенды, меток осей и заголовка графика.
  
### Ошибки и исправления
1. Ошибка: Неправильная загрузка данных.
  Исправление: Убедиться, что данные загружаются правильно, используя правильные параметры функции pandas.read_csv() (или другой функции чтения). Проверить разделители, кодировку и прочие параметры. Учесть возможность использования встроенных датасетов из sklearn или statsmodels.
2. Ошибка: Неправильный выбор факторов и классов (Задание 1).
  Исправление: Убедиться, что выбраны правильные столбцы для факторов и классов, и что они соответствуют ожидаемым данным. Проверить типы данных.
3. Ошибка: Неправильный формат данных для временных рядов (Задание 2).
  Исправление: Преобразовать столбец с датами в формат даты и времени, используя pandas.to_datetime(). Убедиться, что временные ряды имеют числовой формат.
4. Ошибка: Отсутствие легенды и меток.
  Исправление: Добавить matplotlib.pyplot.legend(), matplotlib.pyplot.xlabel(), matplotlib.pyplot.ylabel(), и matplotlib.pyplot.title() для корректного отображения графиков.
5. Ошибка: Некорректное отображение графиков (перекрывающиеся данные, нечитабельные метки).
  Исправление: Настроить размер фигуры (plt.figure(figsize=(width, height))), использовать разные цвета и стили линий, добавить сетку (plt.grid(True)), повернуть метки на оси X (plt.xticks(rotation=45)).

### Выводы
В ходе выполнения лабораторной работы были получены навыки визуализации данных с использованием библиотек Python (pandas, matplotlib). Были решены задачи построения диаграммы рассеяния для анализа взаимосвязи между факторами и классификации данных, а также построения графиков временных рядов для отображения динамики данных во времени. При выполнении работы были выявлены и исправлены ошибки, связанные с загрузкой, обработкой и отображением данных. Полученные навыки могут быть использованы в дальнейшем для анализа и визуализации различных типов данных.

---

## Лабораторная работа 4: "Работа с BioPython"

### Цель работы
Обработка биологических данных в формате GenBank:
1. Объединение файлов
2. Анализ GC-состава
3. Трансляция кодирующих областей

### Задачи
## Задание 1. Формирование исходного файла
1. Загрузить по 5 CDS-последовательностей для двух видов с NCBI в формате GenBank.
2. Объединить записи в единый файл средствами BioPython.
3. Проверить, что итоговый файл содержит не менее 10 CDS.

## Задание 2. Анализ GC-составов
1. Прочитать файл GenBank, извлечь последовательности.
2. Вычислить GC-состав для каждой последовательности.
3. Отсортировать последовательности по возрастанию GC-состава.
4. Вывести результаты с указанием ID, описания и значения GC.

## Задание 3. Трансляция
1. Извлечь кодирующие области (CDS) из файла GenBank.
2. Транслировать нуклеотидные последовательности в аминокислотные.
3. Вывести белковые последовательности с указанием исходных CDS.

### Инструменты
## Задание 1
 Библиотеки:
- `Bio.SeqIO` для чтения/записи GenBank-файлов.
 Алгоритм:
- Скачивание данных с NCBI (вручную).
- Объединение файлов через SeqIO.write(records, "output.gb", "genbank").

## Задание 2
 Библиотеки:
- `Bio.SeqIO` для парсинга GenBank.
- `tkinter` для GUI.
 Алгоритм:
- Чтение файла: SeqIO.parse(filename, "genbank").
- Расчет GC-состава:
 ```python
 gc_content = (seq.count("G") + seq.count("C")) / len(seq)
 ```
- Сортировка: sorted(sequences, key=lambda x: x[2]).

## Задание 3
 Библиотеки:
- `Bio.Seq` для трансляции.
 Алгоритм:
- Извлечение CDS из записей GenBank.
- Трансляция: seq.translate(table="стандартный_код").

### Ошибки и исправления
## Задание 1
1. Ошибка: Несовместимость форматов файлов от разных видов.
- Исправление: Проверка и конвертация в единый формат GenBank.
2. Ошибка: Отсутствие CDS в некоторых записях.
- Исправление: Фильтрация записей с if "CDS" in record.features.

## Задание 2
1. Ошибка: Некорректный расчет GC для пустых последовательностей.
- Исправление: Добавление проверки if len(seq) > 0.
2. Ошибка: Неправильная сортировка из-за строкового сравнения GC.
- Исправление: Преобразование GC в float перед сортировкой.

## Задание 3
1. Ошибка: Трансляция некодирующих областей.
- Исправление: Извлечение только CDS-фрагментов.
2. Ошибка: Игнорирование рамки считывания.
- Исправление: Учет frame в feature.qualifiers.get("transl_table").

### Выводы
- Успешно создан объединенный GenBank-файл с 10+ CDS.
- Реализован расчет и сортировка GC-составов с выводом в GUI.
- Получены белковые последовательности через трансляцию CDS.
