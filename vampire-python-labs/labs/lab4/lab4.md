# Лабораторная работа 4: Работа с BioPython

## Цель работы

Обработка биологических данных в формате GenBank:

•   Объединение файлов
•   Анализ GC-состава
•   Трансляция кодирующих областей

## Задачи

### Задание 1. Формирование исходного файла

•   Загрузить по 5 CDS-последовательностей для двух видов с NCBI в формате GenBank.
•   Объединить записи в единый файл средствами BioPython.
•   Проверить, что итоговый файл содержит не менее 10 CDS.

### Задание 2. Анализ GC-составов

•   Прочитать файл GenBank, извлечь последовательности.
•   Вычислить GC-состав для каждой последовательности.
•   Отсортировать последовательности по возрастанию GC-состава.
•   Вывести результаты с указанием ID, описания и значения GC.

### Задание 3. Трансляция

•   Извлечь кодирующие области (CDS) из файла GenBank.
•   Транслировать нуклеотидные последовательности в аминокислотные.
•   Вывести белковые последовательности с указанием исходных CDS.

## Инструменты

### Задание 1

**Библиотеки:**

•   Bio.SeqIO для чтения/записи GenBank-файлов.

**Алгоритм:**

1.  Скачивание данных с NCBI (вручную).
2.  Объединение файлов через `SeqIO.write(records, "output.gb", "genbank")`.

### Задание 2

**Библиотеки:**

•   Bio.SeqIO для парсинга GenBank.
•   tkinter для GUI.

**Алгоритм:**

1.  Чтение файла: `SeqIO.parse(filename, "genbank")`.
2.  Расчет GC-состава:
python
  gc_content = (seq.count("G") + seq.count("C")) / len(seq)
  ```
3. Сортировка: sorted(sequences, key=lambda x: x[2]).

▌Задание 3

Библиотеки:

•  Bio.Seq для трансляции.

Алгоритм:

1. Извлечение CDS из записей GenBank.
2. Трансляция: seq.translate(table="стандартный_код").

▌Ошибки и исправления

▌Задание 1

•  Ошибка: Несовместимость форматов файлов от разных видов.
  Исправление: Проверка и конвертация в единый формат GenBank.
•  Ошибка: Отсутствие CDS в некоторых записях.
  Исправление: Фильтрация записей с if "CDS" in record.features.

▌Задание 2

•  Ошибка: Некорректный расчет GC для пустых последовательностей.
  Исправление: Добавление проверки if len(seq) > 0.
•  Ошибка: Неправильная сортировка из-за строкового сравнения GC.
  Исправление: Преобразование GC в float перед сортировкой.

▌Задание 3

•  Ошибка: Трансляция некодирующих областей.
  Исправление: Извлечение только CDS-фрагментов.
•  Ошибка: Игнорирование рамки считывания.
  Исправление: Учет frame в feature.qualifiers.get("transl_table").

▌Выводы

Успешно создан объединенный GenBank-файл с 10+ CDS.
Реализован расчет и сортировка GC-составов с выводом в GUI.
Получены белковые последовательности через трансляцию CDS.

▌Файлы с кодом

•  [lab4.py](lab4.py)

```
